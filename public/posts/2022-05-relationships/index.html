





<!DOCTYPE html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="dark"
  data-auto-appearance="true"
><head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="rgb(255,255,255)" />
  
  <title>Useful and Useless Relationship Definitions &middot; PhiloBlog</title>
    <meta name="title" content="Useful and Useless Relationship Definitions &middot; PhiloBlog" />
  
  
  
  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.022d0ebc3b46a335eb1c7ef79b7f2de143d7cd5156d433638592ef1ce5f8554e.js"
    integrity="sha256-Ai0OvDtGozXrHH73m38t4UPXzVFW1DNjhZLvHOX4VU4="
  ></script>
  
  
  
  
  
  
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.c64e8b4df8611ae48d61fd9350eb9e398b672bc049cde05189f34ee93ea00b25.css"
    integrity="sha256-xk6LTfhhGuSNYf2TUOueOYtnK8BJzeBRifNO6T6gCyU="
  />
  
  
  
  
  
  <meta
    name="description"
    content="
      Programmer giving Relationship Advice - A summary about Laravel / Eloquent relationships including some hints, advanced techniques to use and misuse relations
    "
  />
  
  
  
  <link rel="canonical" href="https://www.blog.philodev.one/posts/2022-05-relationships/" />
  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  <meta property="og:title" content="Useful and Useless Relationship Definitions" />
<meta property="og:description" content="Programmer giving Relationship Advice - A summary about Laravel / Eloquent relationships including some hints, advanced techniques to use and misuse relations" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.blog.philodev.one/posts/2022-05-relationships/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-20T14:20:44+02:00" />
<meta property="article:modified_time" content="2022-05-20T14:20:44+02:00" /><meta property="og:site_name" content="Philodev Blog" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Useful and Useless Relationship Definitions"/>
<meta name="twitter:description" content="Programmer giving Relationship Advice - A summary about Laravel / Eloquent relationships including some hints, advanced techniques to use and misuse relations"/>

  
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Useful and Useless Relationship Definitions",
    "headline": "Useful and Useless Relationship Definitions",
    "description": "Programmer giving Relationship Advice - A summary about Laravel \/ Eloquent relationships including some hints, advanced techniques to use and misuse relations",
    "abstract": "Programmer giving Relationship Advice - A summary about Laravel \/ Eloquent relationships including some hints, advanced techniques to use and misuse relations Relationships are great #Relational Databases like mySql or postgres tend to have that thing called relations.",
    "inLanguage": "en",
    "url" : "https:\/\/www.blog.philodev.one\/posts\/2022-05-relationships\/",
    "author" : {
      "@type": "Person",
      "name": ""
    },
    "copyrightYear": "2022",
    "dateCreated": "2022-05-20T14:20:44\u002b02:00",
    "datePublished": "2022-05-20T14:20:44\u002b02:00",
    
    "dateModified": "2022-05-20T14:20:44\u002b02:00",
    
    "keywords": ["Development","Laravel"],
    
    "mainEntityOfPage": "true",
    "wordCount": "1763"
  }
  </script>


  
  
  
  
  

  
  
  
  
  <script defer type="text/javascript" src="/js/mermaid.bundle.d49df8124a470da7fa8e771b4a7396654bac3e8bff8586a245f23b17963fd546efef41576d859e550ee9dca6885081108335adefb6e12f8766157398f102976e.js" integrity="sha512-1J34EkpHDaf6jncbSnOWZUusPov/hYaiRfI7F5Y/1Ubv70FXbYWeVQ7p3KaIUIEQgzWt77bhL4dmFXOY8QKXbg=="></script>






  
  
  
  
  

  
  
</head>
<body
    class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"
  >
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content"
        ><span class="font-bold pe-2 text-primary-600 dark:text-primary-400">&darr;</span
        >Skip to main content</a
      >
    </div>
    
    
      <header class="py-6 font-semibold text-neutral-900 dark:text-neutral print:hidden sm:py-10">
  <nav class="flex items-start justify-between sm:items-center">
    
    <div class="flex flex-row items-center">
      
  <a
    class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
    rel="me"
    href="/"
    >PhiloBlog</a
  >

    </div>
    
    
      <ul class="flex flex-col list-none text-end sm:flex-row">
        
          
            
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5">
              
                <a
                  href="/posts/"
                  title="Posts"
                  
                  ><span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >Blog</span
                    >
                  </a
                >
              
            </li>
          
            
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5">
              
                <a
                  href="https://www.philodev.one"
                  title=""
                  
                  ><span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >About Philodev</span
                    >
                  </a
                >
              
            </li>
          
            
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5">
              
                <a
                  href="/tags/"
                  title="Tags"
                  
                  ><span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >Tags</span
                    >
                  </a
                >
              
            </li>
          
          
        
      </ul>
    
  </nav>
</header>

    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  <article>
    <header class="max-w-prose">
      
        <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/"
      >PhiloBlog</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline ">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/"
      >Posts</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/2022-05-relationships/"
      >Useful and Useless Relationship Definitions</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Useful and Useless Relationship Definitions
      </h1>
      <div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
    
  

  

  

  
    
  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2022-05-20 14:20:44 &#43;0200 CEST">20 May 2022</time><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">9 mins</span>
    

    
    
  </div>

  
  


      </div>
      
    </header>
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
        <div class="order-first px-0 lg:order-last lg:max-w-xs lg:ps-8">
          <div class="toc pe-5 print:hidden lg:sticky lg:top-10">
            <details open class="-ms-5 mt-0 overflow-hidden rounded-lg ps-5">
  <summary
    class="-ms-5 block cursor-pointer bg-neutral-100 py-1 ps-5 text-lg font-semibold text-neutral-800 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden"
  >
    Table of Contents
  </summary>
  <div class="-ms-5 border-s border-dotted border-neutral-300 py-2 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#relationships-are-great">Relationships are great</a></li>
        <li><a href="#example-database-structure">Example Database structure</a>
          <ul>
            <li><a href="#class-diagram">Class diagram</a></li>
          </ul>
        </li>
        <li><a href="#one-to-one">One to One</a>
          <ul>
            <li><a href="#hasone-and-belongsto"><strong>HasOne</strong> and <strong>BelongsTo</strong></a></li>
            <li><a href="#creative-usage-of-the-extra-parameters">&ldquo;Creative&rdquo; usage of the extra Parameters</a></li>
            <li><a href="#default-models">Default Models</a></li>
          </ul>
        </li>
        <li><a href="#one-to-many">One To Many</a>
          <ul>
            <li><a href="#hasmany-and-belongsto"><strong>HasMany</strong> and <strong>BelongsTo</strong></a></li>
            <li><a href="#queries-in-relations">Queries in Relations</a></li>
            <li><a href="#using-hasone-ofmany">Using <strong>HasOne</strong>-&gt;ofMany</a></li>
            <li><a href="#creative-one-to-many-relations">&ldquo;Creative&rdquo; One to Many Relations</a></li>
            <li><a href="#having-things-through">Having Things Through</a>
              <ul>
                <li><a href="#creative-hasmanythroughs">&ldquo;Creative&rdquo; HasManyThroughs</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#many-to-many">Many To Many</a>
          <ul>
            <li><a href="#creative-many-to-many-relations">&ldquo;Creative&rdquo; Many to Many Relations</a></li>
          </ul>
        </li>
        <li><a href="#last-words">Last words</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>

          </div>
        </div>
      
      <div class="min-w-0 min-h-0 max-w-prose grow">
        <div class="lead !mb-9 text-xl">
  Programmer giving Relationship Advice - A summary about Laravel / Eloquent relationships including some
hints, advanced techniques to use and misuse relations
</div>

<h2 id="relationships-are-great" class="relative group">Relationships are great <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#relationships-are-great" aria-label="Anchor">#</a></span></h2><p>Relational Databases like mySql or postgres tend to have that thing called relations. There are used in almost all
Laravel Projects with a database and most Laravel developers know them and know how to use them. But not every developer
knows <a href="https://laravel.com/docs/9.x/eloquent-relationships" target="_blank" rel="noreferrer">the Laravel Docs</a> by heart and there are even some features
that are not mentioned in the Laravel Docs at all, but can only be discovered by clicking through the Eloquent code.</p>
<p>




  
  
    
  
  
    <figure>
      <img
        class="mx-auto my-0 rounded-md"
        
          width="2732"
          height="2048"
          
            srcset="/images/2022-05-relations_hu4bf8192c8d8917bb710e5f2345bb1b47_841021_330x0_resize_box_3.png 330w,/images/2022-05-relations_hu4bf8192c8d8917bb710e5f2345bb1b47_841021_660x0_resize_box_3.png 660w,/images/2022-05-relations_hu4bf8192c8d8917bb710e5f2345bb1b47_841021_1024x0_resize_box_3.png 1024w,/images/2022-05-relations_hu4bf8192c8d8917bb710e5f2345bb1b47_841021_1320x0_resize_box_3.png 2x"
            src="/images/2022-05-relations_hu4bf8192c8d8917bb710e5f2345bb1b47_841021_660x0_resize_box_3.png"
          
        
        alt="Example Image with Humans, Dogs, and Toys to explain Relationships"
        
          loading="lazy"
        
      />
      
    </figure>
  
</p>
<p>This blog post wants to sum up the basic relations Eloquent offers, hinting at some special ways to define relations and
advanced techniques to create relations that might be useful for querying. However, this post does not cover the usage
of relations, their benefits for query optimization, or general explanations of how they work (for learning that I
recommend the Laravel Docs or <a href="https://geekflare.com/laravel-eloquent-model-relationship/" target="_blank" rel="noreferrer">this Blog Article</a>) - only
the definition of them.</p>
<h2 id="example-database-structure" class="relative group">Example Database structure <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#example-database-structure" aria-label="Anchor">#</a></span></h2><p>Let&rsquo;s play a game, shall we? Let&rsquo;s have some <code>games</code>, each with a <code>hostPlayer</code>, some <code>players</code> who belong to a game and
a user. A game consists of multiple <code>rounds</code>, in each round one player is active, and all players may make a <code>move</code>
resulting in a score per round.</p>
<h3 id="class-diagram" class="relative group">Class diagram <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#class-diagram" aria-label="Anchor">#</a></span></h3><pre tabindex="0"><code><div class="mermaid" align="center">
   
classDiagram 
Move --> Round : Round has many Moves, </br> Move belongs to a Round
Round --> Player : Player has many Rounds as Active-Player, </br> Round belongs to an Active-Player
Round --> Game : Game has many Rounds, </br> Round belongs to a Game 
Move --> Player : Player has many Moves, </br> Move belongs to a Player 
Player --> Game : Game has many Players, </br> Player belongs to a Game 
Game --> Player : Player has many Games as Host, </br> Game belongs to a Host-Player


class Game { 
id
host_player_id
started_at
}

class Player { 
id
game_id
user_id
color
}

class Round { 
id
game_id
active_player_id
completed_at
}

class Move { 
id
round_id
player_id
score
}


</div>

</code></pre><h2 id="one-to-one" class="relative group">One to One <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#one-to-one" aria-label="Anchor">#</a></span></h2><h3 id="hasone-and-belongsto" class="relative group"><strong>HasOne</strong> and <strong>BelongsTo</strong> <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#hasone-and-belongsto" aria-label="Anchor">#</a></span></h3><p>If a model has a column containing another model&rsquo;s id, forming a One to One Relationship. Every Relationship has its
inverse form - if a User <strong>HasOne</strong> Level, a Level <strong>BelongsTo</strong> a User. A Model with a <strong>HasOne</strong>
says &ldquo;the id of mine is in on another table&rdquo;, the standard example would be:</p>
<pre tabindex="0"><code><div class="mermaid" align="center">
   
classDiagram 
User <-- Level: User has one Level </br> Level belongs to User

class User { 
id 
email 
password
}

class Level { 
id 
user_id 
over_all_score
}


</div>

</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">Model</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">level</span><span class="p">()</span><span class="o">:</span> <span class="nx">\Illuminate\Database\Eloquent\Relations\HasOne</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasOne</span><span class="p">(</span><span class="nx">Level</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Level</span> <span class="k">extends</span> <span class="nx">Model</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">user</span><span class="p">()</span><span class="o">:</span> <span class="nx">\Illuminate\Database\Eloquent\Relations\BelongsTo</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsTo</span><span class="p">(</span><span class="nx">User</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span></code></pre></div><h3 id="creative-usage-of-the-extra-parameters" class="relative group">&ldquo;Creative&rdquo; usage of the extra Parameters <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#creative-usage-of-the-extra-parameters" aria-label="Anchor">#</a></span></h3><p><strong>A word on parameter naming</strong> The <code>something_id</code> column is called <code>foreign_id</code>, while the id column of this model is
referred to as <code>local_id</code>; the model to which this foreign_id belongs is the owner model, and its id column is referred
to as <code>owner_id</code>. In Laravel it is possible to enter alternative values (other than Laravel&rsquo;s guessed
values <code>$this-&gt;belongsTo(User::class, 'user_id', 'id')</code>) for reasons like using <code>uuids</code> or naming conventions.</p>
<p>But you can use these parameters also in more creative ways, let&rsquo;s say you want to display the level of the user next to
a players icon:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Player</span> <span class="k">extends</span> <span class="nx">Model</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">level</span><span class="p">()</span><span class="o">:</span> <span class="nx">\Illuminate\Database\Eloquent\Relations\HasOne</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasOne</span><span class="p">(</span><span class="nx">Level</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;user_id&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span></code></pre></div><div class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900">
  <span class="pe-3 text-primary-400">
    <span class="relative inline-block align-text-bottom px-1 icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>
</span>
  </span>
  <span class="dark:text-neutral-300">The idea of &ldquo;misusing&rdquo; relations in this way is considerable, strange, not intuitive for readers, and confusing for
beginners - so maybe just don&rsquo;t do them. With this blog post I just want to point out, that this way of working with
relationships is possible, works for some cases great, and is kinda fun to think about.</span>
</div>

<p>If I need the relation (for eager loading, query optimization&hellip;) it is handy to take the shortcut of just using the
user_ids. The problems I want to point out:</p>
<ul>
<li>Using the create function will not create a user, and honestly, I have no idea what would happen or which id would be
set there</li>
<li>This query will not check if the user exists or is deleted</li>
</ul>
<h3 id="default-models" class="relative group">Default Models <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#default-models" aria-label="Anchor">#</a></span></h3><p>Both <strong>HasOne</strong> and <strong>BelongsTo</strong> relations may have a default which (for example for a level) comes in handy because
you don&rsquo;t have to store a model for a user who maybe never plays a game.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">level</span><span class="p">()</span><span class="o">:</span> <span class="nx">\Illuminate\Database\Eloquent\Relations\HasOne</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasOne</span><span class="p">(</span><span class="nx">Level</span><span class="o">::</span><span class="na">class</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">withDefault</span><span class="p">([</span><span class="s1">&#39;overall_score&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><h2 id="one-to-many" class="relative group">One To Many <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#one-to-many" aria-label="Anchor">#</a></span></h2><h3 id="hasmany-and-belongsto" class="relative group"><strong>HasMany</strong> and <strong>BelongsTo</strong> <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#hasmany-and-belongsto" aria-label="Anchor">#</a></span></h3><p>The more common One to Many relations are indistinguishable from a database perspective (if there is no <code>unique</code>
constraint on the foreign key column). The difference is the possibility of the Owner to have more than one model
belonging to it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Game</span> <span class="k">extends</span> <span class="nx">Model</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">rounds</span><span class="p">()</span><span class="o">:</span> <span class="nx">\Illuminate\Database\Eloquent\Relations\HasMany</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasMany</span><span class="p">(</span><span class="nx">Round</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Round</span> <span class="k">extends</span> <span class="nx">Model</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">game</span><span class="p">()</span><span class="o">:</span> <span class="nx">\Illuminate\Database\Eloquent\Relations\BelongsTo</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsTo</span><span class="p">(</span><span class="nx">Game</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span></code></pre></div><h3 id="queries-in-relations" class="relative group">Queries in Relations <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#queries-in-relations" aria-label="Anchor">#</a></span></h3><p>Compared to <code>ofMany</code> adding extra queries on the relation is possible as well and can come in quite handy:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Game</span> <span class="k">extends</span> <span class="nx">Model</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">redPlayers</span><span class="p">()</span><span class="o">:</span> <span class="nx">\Illuminate\Database\Eloquent\Relations\HasMany</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasMany</span><span class="p">(</span><span class="nx">Player</span><span class="o">::</span><span class="na">class</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">playersWithoutMove</span><span class="p">()</span><span class="o">:</span> <span class="nx">\Illuminate\Database\Eloquent\Relations\HasMany</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasMany</span><span class="p">(</span><span class="nx">Player</span><span class="o">::</span><span class="na">class</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">whereDosntHave</span><span class="p">(</span><span class="s1">&#39;move&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="using-hasone-ofmany" class="relative group">Using <strong>HasOne</strong>-&gt;ofMany <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#using-hasone-ofmany" aria-label="Anchor">#</a></span></h3><p>But <code>HasOne</code> also offers great options if you are often looking for one special model of a <strong>HasMany</strong> Relationship.
This use case is very common, so I think the <code>ofMany</code> function is underrated.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Round</span> <span class="k">extends</span> <span class="nx">Model</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// latest (current) Move
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">latestMove</span><span class="p">()</span><span class="o">:</span> <span class="nx">\Illuminate\Database\Eloquent\Relations\HasOne</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasOne</span><span class="p">(</span><span class="nx">Move</span><span class="o">::</span><span class="na">class</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">latestOfMany</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// best Move
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">latestMove</span><span class="p">()</span><span class="o">:</span> <span class="nx">\Illuminate\Database\Eloquent\Relations\HasOne</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasOne</span><span class="p">(</span><span class="nx">Move</span><span class="o">::</span><span class="na">class</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">latestOfMany</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// best, latest move where score is positive
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">bestLatestMoveWithPositiveScore</span><span class="p">()</span><span class="o">:</span> <span class="nx">\Illuminate\Database\Eloquent\Relations\HasOne</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasOne</span><span class="p">(</span><span class="nx">Move</span><span class="o">::</span><span class="na">class</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">ofMany</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="p">[</span><span class="s1">&#39;created_at&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;max&#39;</span><span class="p">],</span> 
</span></span><span class="line"><span class="cl">            <span class="nx">fn</span> <span class="p">(</span><span class="nv">$query</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span></code></pre></div><h3 id="creative-one-to-many-relations" class="relative group">&ldquo;Creative&rdquo; One to Many Relations <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#creative-one-to-many-relations" aria-label="Anchor">#</a></span></h3><p>Breaking it down to the minimal requirement, a <code>HasMany</code> relation requires that there is another table, which holds an
identifier that the local table holds as well.</p>
<p>If you look at our class diagram, for example, there is no direct connection between <code>Move</code> and <code>Game</code>, if you want the
moves of a game you have to use the <code>Round</code> as a middleman. Now let&rsquo;s say I want a statistic that proves that my game is
fair and that the host player does not make moves with higher scores or so - whatever reason I might have to create such
a relation.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Game</span> <span class="k">extends</span> <span class="nx">Model</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">hostPlayerMoves</span><span class="p">()</span><span class="o">:</span> <span class="nx">\Illuminate\Database\Eloquent\Relations\HasMany</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasMany</span><span class="p">(</span><span class="nx">Moves</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;player_id&#39;</span><span class="p">,</span> <span class="s1">&#39;host_player_id&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span></code></pre></div><div class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900">
  <span class="pe-3 text-primary-400">
    <span class="relative inline-block align-text-bottom px-1 icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>
</span>
  </span>
  <span class="dark:text-neutral-300">Again, creating this kind of relationships might be smelly or hacky, but it can be handy if you keep the possibilities
in mind that relations offer.</span>
</div>

<h3 id="having-things-through" class="relative group">Having Things Through <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#having-things-through" aria-label="Anchor">#</a></span></h3><p>Laravel provides a relation for two consecutive <code>HasMany</code> relations.</p>
<pre tabindex="0"><code><div class="mermaid" align="center">
   
classDiagram 
Round --> Game : Game has many Rounds, </br> Round belongs to a Game 
Move --> Round : Round has many Moves, </br> Move belongs to a Round
Move <-- Game : Game has many Moves through Round

class Game { 
id
host_player_id
started_at
}

class Round { 
id
game_id
active_player_id
completed_at
}

class Move { 
id
round_id
player_id
score
}


</div>

</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Game</span> <span class="k">extends</span> <span class="nx">Model</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">moves</span><span class="p">()</span><span class="o">:</span> <span class="nx">\Illuminate\Database\Eloquent\Relations\HasManyThrough</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasManyThrough</span><span class="p">(</span><span class="nx">Move</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="nx">Round</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span></code></pre></div><h4 id="creative-hasmanythroughs" class="relative group">&ldquo;Creative&rdquo; HasManyThroughs <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#creative-hasmanythroughs" aria-label="Anchor">#</a></span></h4><p>Let&rsquo;s say we want to display the Level of the overall Game - maybe to match with other Games or whatever. Again we can
use the additional parameters to skip some tables on the way between Game and Level. Usually, we would start at the
Game, and look for the players, look for the users, look for the levels. But both the levels and the players share the
same user_id - why not skip the User?</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Game</span> <span class="k">extends</span> <span class="nx">Model</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">levels</span><span class="p">()</span><span class="o">:</span> <span class="nx">\Illuminate\Database\Eloquent\Relations\HasManyThrough</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasManyThrough</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="nx">Level</span><span class="o">::</span><span class="na">class</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">Player</span><span class="o">::</span><span class="na">class</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;game_id&#39;</span><span class="p">,</span> <span class="c1">// Foreign key on the players table
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="c1">// Foreign key on the levels table
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="c1">// Local key on the games table
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="s1">&#39;user_id&#39;</span> <span class="c1">// Local key on the players table
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span></code></pre></div><div class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900">
  <span class="pe-3 text-primary-400">
    <span class="relative inline-block align-text-bottom px-1 icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>
</span>
  </span>
  <span class="dark:text-neutral-300">Again, creating this kind of relationships might be smelly or hacky, but it can be handy if you keep the possibilities
in mind that relations offer.</span>
</div>

<h2 id="many-to-many" class="relative group">Many To Many <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#many-to-many" aria-label="Anchor">#</a></span></h2><p>Many to Many relations are the kind of relations that require a pivot table. If compared to the implementation depicted
in the examples above, where a user has a player per game I could have implemented a Many to Many relation using
a <code>game_user</code> or <code>game^user</code> or <code>games_2_users</code> table or other conventional namings for pivot tables. That would look
like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Game</span> <span class="k">extends</span> <span class="nx">Model</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">player</span><span class="p">()</span><span class="o">:</span> <span class="nx">\Illuminate\Database\Eloquent\Relations\HasManyThrough</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsToMany</span><span class="p">(</span><span class="nx">User</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;game_user&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span></code></pre></div><p>The point I don&rsquo;t like about this is #1 the naming convention does not reflect the meaning of the relation; I prefer
calling a thing by their name, in this case, <code>players</code>. 2# The first thing especially bugs me after you start adding
more columns in the pivot table, starting with timestamps, then maybe a soft delete, and then a custom link or so. At
some point, a lot of the pivot tables I saw would have looked cleaner, and caused less code smell if they were models
from the very beginning.</p>
<p>This does not mean, that many to many relations are useless. As I mentioned in the last examples, there are many ways to
use the additional parameters in the relationship functions. So if you see <code>Player</code> as a pivot model, you can still
define this relation:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Game</span> <span class="k">extends</span> <span class="nx">Model</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">users</span><span class="p">()</span><span class="o">:</span> <span class="nx">\Illuminate\Database\Eloquent\Relations\BelongsToMany</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsToMany</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="nx">User</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="c1">// target model
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="s1">&#39;players&#39;</span><span class="p">,</span> <span class="c1">// pivot table
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="s1">&#39;game_id&#39;</span><span class="p">,</span> <span class="c1">// Foreign key on pivot player table
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="c1">// Foreign key on pivot player table
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="c1">// Parent key on the games table
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="s1">&#39;id&#39;</span> <span class="c1">// Related key on the users table
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span></code></pre></div><p>Any table with two foreign ids may be used as a pivot table!</p>
<h3 id="creative-many-to-many-relations" class="relative group">&ldquo;Creative&rdquo; Many to Many Relations <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#creative-many-to-many-relations" aria-label="Anchor">#</a></span></h3><p>You may again use this information even further and again create sometimes useful relations by using the additional
function parameters. For example, if you want to have the Levels instead of the Users of a Game.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Game</span> <span class="k">extends</span> <span class="nx">Model</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">levels</span><span class="p">()</span><span class="o">:</span> <span class="nx">\Illuminate\Database\Eloquent\Relations\BelongsToMany</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsToMany</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="nx">Level</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="c1">// target model
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="s1">&#39;players&#39;</span><span class="p">,</span> <span class="c1">// pivot table
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="s1">&#39;game_id&#39;</span><span class="p">,</span> <span class="c1">// Foreign key on pivot player table
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="c1">// Foreign key on pivot player table
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="c1">// Parent key on the games table
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="s1">&#39;user_id&#39;</span> <span class="c1">// Related key on the levels table
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span></code></pre></div><h2 id="last-words" class="relative group">Last words <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#last-words" aria-label="Anchor">#</a></span></h2><p>This was a collection of infos, hints, and hacks about the definition of Laravel or Eloquent Relationships. If you found
any mistakes or have additional tricks please feel free to contact me :D</p>
<p>Happy coding</p>

      </div>
    </section>
    <footer class="pt-8 max-w-prose print:hidden">
      
  <div class="flex">
    
    <div class="place-self-center">
      
      
      <div class="text-2xl sm:text-lg">
</div>
    </div>
  </div>


      

      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="group flex" href="/posts/2022-05-custom-query-builder-pattern/">
              <span
                class="me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"
                ><span class="ltr:inline rtl:hidden">&larr;</span
                ><span class="ltr:hidden rtl:inline">&rarr;</span></span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Model Specific Query Builder - an Alternative to Scopes</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2022-05-14 08:20:44 &#43;0200 CEST">14 May 2022</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="group flex text-right" href="/posts/2022-05-driver-manager-pattern/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Manager and Driver Pattern - pattern, implementation, and usage</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2022-05-22 08:13:44 &#43;0200 CEST">22 May 2022</time>
                  
                </span>
              </span>
              <span
                class="ms-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"
                ><span class="ltr:inline rtl:hidden">&rarr;</span
                ><span class="ltr:hidden rtl:inline">&larr;</span></span
              >
            </a>
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        
          <div class="pointer-events-none absolute bottom-0 end-0 top-[100vh] w-12">
            <a
              href="#the-top"
              class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
              aria-label="Scroll to top"
              title="Scroll to top"
            >
              &uarr;
            </a>
          </div>
        
      </main><footer class="py-10 print:hidden">
  
  
  <div class="flex items-center justify-between">
    <div>
      
      
        <p class="text-sm text-neutral-500 dark:text-neutral-400">
            &copy;
            2023
            
        </p>
      
      
      
        <p class="text-xs text-neutral-500 dark:text-neutral-400">
          
          
          Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
            href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href="https://github.com/jpanther/congo" target="_blank" rel="noopener noreferrer">Congo</a>
        </p>
      
    </div>
    <div class="flex flex-row items-center">
      
      
      
      
        <div
          class="me-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        >
          <button id="appearance-switcher-0" type="button" aria-label="appearance switcher">
            <div
              class="flex items-center justify-center w-12 h-12 dark:hidden"
              title="Switch to dark appearance"
            >
              <span class="relative inline-block align-text-bottom px-1 icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
            </div>
            <div
              class="items-center justify-center hidden w-12 h-12 dark:flex"
              title="Switch to light appearance"
            >
              <span class="relative inline-block align-text-bottom px-1 icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
            </div>
          </button>
        </div>
      
    </div>
  </div>
  
  
</footer>

    </div>
  </body>
</html>
