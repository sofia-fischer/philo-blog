<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#FFFFFF"><title>Event Sourcing for long living projects &#183; PhiloBlog</title>
<meta name=title content="Event Sourcing for long living projects &#183; PhiloBlog"><script type=text/javascript src=/js/appearance.min.8a082f81b27f3cb2ee528df0b0bdc39787034cf2cc34d4669fbc9977c929023c.js integrity="sha256-iggvgbJ/PLLuUo3wsL3Dl4cDTPLMNNRmn7yZd8kpAjw="></script><link type=text/css rel=stylesheet href=/css/main.bundle.min.cd65e744f39f2e1530fc9baa021748abbe422c38751e5618d85bc544b7eae4c1.css integrity="sha256-zWXnRPOfLhUw/JuqAhdIq75CLDh1HlYY2FvFRLfq5ME="><meta name=description content="
      Event Sourcing is a software pattern for stateful entity management. Instead of storing the current state of an Entity, only the state changes are stored. This blog post is about the advantages and disadvantages of the pattern, and how to avoid some challenges I faced in long living projects.
    "><link rel=canonical href=https://www.blog.philodev.one/posts/2024-04-event-sourcing/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://www.blog.philodev.one/posts/2024-04-event-sourcing/"><meta property="og:site_name" content="PhiloBlog"><meta property="og:title" content="Event Sourcing for long living projects"><meta property="og:description" content="Event Sourcing is a software pattern for stateful entity management. Instead of storing the current state of an Entity, only the state changes are stored. This blog post is about the advantages and disadvantages of the pattern, and how to avoid some challenges I faced in long living projects."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-04-28T10:20:44+02:00"><meta property="article:modified_time" content="2024-04-28T10:20:44+02:00"><meta property="article:tag" content="Development"><meta property="article:tag" content="Software Pattern"><meta property="article:tag" content="Symfony"><meta name=twitter:card content="summary"><meta name=twitter:title content="Event Sourcing for long living projects"><meta name=twitter:description content="Event Sourcing is a software pattern for stateful entity management. Instead of storing the current state of an Entity, only the state changes are stored. This blog post is about the advantages and disadvantages of the pattern, and how to avoid some challenges I faced in long living projects."><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Event Sourcing for long living projects","headline":"Event Sourcing for long living projects","description":"Event Sourcing is a software pattern for stateful entity management. Instead of storing the current state of an Entity, only the state changes are stored. This blog post is about the advantages and disadvantages of the pattern, and how to avoid some challenges I faced in long living projects.","abstract":"Event Sourcing is a software pattern for stateful entity management.","inLanguage":"en","url":"https:\/\/www.blog.philodev.one\/posts\/2024-04-event-sourcing\/","author":{"@type":"Person","name":"Sofia Fischer"},"copyrightYear":"2024","dateCreated":"2024-04-28T10:20:44\u002b02:00","datePublished":"2024-04-28T10:20:44\u002b02:00","dateModified":"2024-04-28T10:20:44\u002b02:00","keywords":["Development","Software Pattern","Symfony"],"mainEntityOfPage":"true","wordCount":"2008"}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://www.blog.philodev.one/","name":"Philo Blog","position":1},{"@type":"ListItem","item":"https://www.blog.philodev.one/posts/","name":"Posts","position":2},{"@type":"ListItem","name":"Event Sourcing for Long Living Projects","position":3}]}</script><meta name=author content="Sofia Fischer"><link href=mailto:sofia@philodev.com rel=me><link href=https://github.com/sofia-fischer rel=me><link href=https://www.linkedin.com/in/sofia-fischer-58b1611b9/ rel=me></head><body class="m-auto flex h-screen max-w-7xl flex-col bg-neutral px-6 text-lg leading-7 text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="-translate-y-8 rounded-b-lg bg-primary-200 px-3 py-1 text-sm focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="pe-2 font-bold text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="py-6 font-semibold text-neutral-900 dark:text-neutral sm:py-10 print:hidden"><nav class="flex items-start justify-between sm:items-center"><div class="flex flex-row items-center"><a href=/ class=mr-2><img src=/logo.png width=1012 height=1012 class="max-h-[10rem] max-w-[10rem] object-scale-down object-left" alt=PhiloBlog>
</a><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>PhiloBlog</a></div><ul class="flex list-none flex-col text-end sm:flex-row"><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=/posts/ title><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Posts</span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=/tags/ title><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Tags</span></a></li></ul></nav></header><div class="relative flex grow flex-col"><main id=main-content class=grow><article><header class=max-w-prose><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class="hidden inline"><a class="dark:underline-neutral-600 decoration-neutral-300 hover:underline" href=/>PhiloBlog</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="dark:underline-neutral-600 decoration-neutral-300 hover:underline" href=/posts/>Posts</a><span class="px-1 text-primary-500">/</span></li><li class="hidden inline"><a class="dark:underline-neutral-600 decoration-neutral-300 hover:underline" href=/posts/2024-04-event-sourcing/>Event Sourcing for long living projects</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mb-8 mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Event Sourcing for long living projects</h1><div class="mb-10 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2024-04-28 10:20:44 +0200 CEST">28 April 2024</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">10 mins</span></div><div class="my-1 flex flex-wrap text-xs leading-relaxed text-neutral-500 dark:text-neutral-400"><a href=/tags/development/ class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">Development</a>
<a href=/tags/software-pattern/ class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">Software Pattern</a>
<a href=/tags/symfony/ class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">Symfony</a></div></div></header><section class="prose mt-0 flex max-w-full flex-col dark:prose-invert lg:flex-row"><div class="order-first px-0 lg:order-last lg:max-w-xs lg:ps-8"><div class="toc pe-5 lg:sticky lg:top-10 print:hidden"><details open class="-ms-5 mt-0 overflow-hidden rounded-lg ps-5"><summary class="block cursor-pointer bg-neutral-100 py-1 ps-5 text-lg font-semibold text-neutral-800 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="border-s border-dotted border-neutral-300 py-2 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><ul><li><a href=#about-event-sourcing>About Event Sourcing</a><ul><li><a href=#implementation-idea>Implementation Idea</a></li><li><a href=#advantages>Advantages</a></li><li><a href=#disadvantages>Disadvantages</a></li></ul></li><li><a href=#event-sourcing-in-long-living-projects>Event Sourcing in long living projects</a><ul><li><a href=#the-database-decision>The database decision</a></li><li><a href=#event-versioning-using-a-discriminator-map>Event Versioning using a discriminator map</a></li><li><a href=#event-deserialization>Event deserialization</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></li></ul></nav></div></details></div></div><div class="min-h-0 min-w-0 max-w-prose grow"><div class="lead !mb-9 text-xl">Event Sourcing is a software pattern for stateful entity management. Instead of storing the current state of an Entity,
only the state changes are stored. This blog post is about the advantages and disadvantages of the pattern, and how to
avoid some challenges I faced in long living projects.</div><h2 id=about-event-sourcing class="relative group">About Event Sourcing <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#about-event-sourcing aria-label=Anchor>#</a></span></h2><p>Event Sourcing is a software pattern for stateful entity management. Instead of storing the current state of an (
aggregate) entity, the state is derived from a sequence of (domain) events.</p><p>To implement such a pattern, the entity must have some kind of livecycle. This can be a finite state machine, for
example the state of an order (<code>placed</code>, <code>paid</code>, <code>shipped</code>, <code>delivered</code>, <code>returnRequested</code> &mldr;); or a tracking of state
like a bank account (<code>+12.4€</code>, <code>-0.33€</code>, <code>+145.29</code>, &mldr;).
In any case, the final entity state is derived from the sequence of events that happened to the entity.</p><h3 id=implementation-idea class="relative group">Implementation Idea <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#implementation-idea aria-label=Anchor>#</a></span></h3><p>Arbitrary Idea for the Implementation: &ldquo;As a Dog Owner, I want a system to track the contest results of my dog&rdquo;.</p><p>Let&rsquo;s start with the event requirements.
The Product/Dog Owner wants a list of all the contests, and track the current state of their dog. This includes if the
current local Dog License is passed or not, what the last achievement was, and what the all-time record ranking of the
dog is.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>abstract</span> <span class=k>class</span> <span class=nc>Achievement</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=nx>readonly</span> <span class=nx>DateTime</span> <span class=nv>$recordedAt</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>DateTime</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>(</span><span class=k>private</span> <span class=nx>string</span> <span class=nv>$contestIdentifier</span><span class=p>,</span> <span class=nx>DateTimeImmutable</span> <span class=nv>$recordedAt</span> <span class=o>=</span> <span class=k>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>recordedAt</span> <span class=o>=</span> <span class=nv>$recordedAt</span> <span class=o>??</span> <span class=k>new</span> <span class=nx>DateTime</span><span class=p>();</span>        
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ObedienceAchievement</span> <span class=k>extends</span> <span class=nx>Achievement</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>(</span><span class=k>private</span> <span class=nx>string</span> <span class=nv>$contestIdentifier</span><span class=p>,</span> <span class=k>private</span> <span class=nx>int</span> <span class=nv>$points</span><span class=p>,</span> <span class=k>private</span> <span class=nx>int</span> <span class=nv>$ranking</span><span class=p>,</span> <span class=nx>DateTimeImmutable</span> <span class=nv>$recordedAt</span> <span class=o>=</span> <span class=k>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>parent</span><span class=o>::</span><span class=na>__construct</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>contestIdentifier</span><span class=p>,</span> <span class=nv>$recordedAt</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>DogLicenseAchievement</span> <span class=k>extends</span> <span class=nx>Achievement</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>(</span><span class=k>private</span> <span class=nx>string</span> <span class=nv>$contestIdentifier</span><span class=p>,</span> <span class=k>private</span> <span class=nx>bool</span> <span class=nv>$passed</span><span class=p>,</span> <span class=nx>DateTimeImmutable</span> <span class=nv>$recordedAt</span> <span class=o>=</span> <span class=k>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>parent</span><span class=o>::</span><span class=na>__construct</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>contestIdentifier</span><span class=p>,</span> <span class=nv>$recordedAt</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// The Event Table
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>CREATE</span> <span class=nx>TABLE</span> <span class=nx>achievements</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nx>id</span> <span class=nx>UUID</span> <span class=k>NOT</span> <span class=k>NULL</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>dog_id</span> <span class=nx>UUID</span> <span class=k>NOT</span> <span class=k>NULL</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>context_identifier</span> <span class=nx>VARCHAR</span> <span class=k>NOT</span> <span class=k>NULL</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>recorded_at</span> <span class=nx>TIMESTAMP</span> <span class=k>NOT</span> <span class=k>NULL</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>data</span> <span class=nx>JSON</span> <span class=k>NOT</span> <span class=k>NULL</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span></code></pre></div><p>This makes storing new achievements very easy, the controller can do a single, very fast query to add the newest
achievement to the database without caring about any state change.
Because of the different event types with different data, the <code>data</code> column is a JSON column, like no developer ever
regretted adding json data fields in relational databases. The <code>dogId</code> is not part of the event, but part of the table
to ensure a foreign relation to a dogs table, which holds data that does not change the state, e.g. the breed, owner, or
birthday.</p><p>Now to the entity, the Dog. Ignoring the contents of the dogs table, the Dog Entity is made up of an apply function,
which on instantiation applies each event until the current state is reproduced.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>class</span> <span class=nc>Dog</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>array</span> <span class=nv>$achievements</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=nx>bool</span> <span class=nv>$dogLicensePassed</span> <span class=o>=</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=o>?</span><span class=nx>int</span> <span class=nv>$allTimeRanking</span> <span class=o>=</span> <span class=k>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=o>?</span><span class=nx>int</span> <span class=nv>$lastObediencePoints</span> <span class=o>=</span> <span class=k>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=o>?</span><span class=nx>DateTime</span> <span class=nv>$lastAchievement</span> <span class=o>=</span> <span class=k>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>apply</span><span class=p>(</span><span class=k>array</span> <span class=nv>$achievements</span><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>achievements</span><span class=p>[]</span> <span class=o>=</span> <span class=nv>$achievement</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>foreach</span> <span class=p>(</span><span class=nv>$achievements</span> <span class=k>as</span> <span class=nv>$achievement</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>lastAchievement</span> <span class=o>=</span> <span class=nv>$achievement</span><span class=o>-&gt;</span><span class=na>recordedAt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>            <span class=k>switch</span> <span class=p>(</span><span class=k>true</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>case</span> <span class=nv>$achievement</span> <span class=nx>instanceof</span> <span class=nx>ObedienceAchievement</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>lastObediencePoints</span> <span class=o>=</span> <span class=nv>$achievement</span><span class=o>-&gt;</span><span class=na>points</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>allTimeRanking</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>allTimeRanking</span> <span class=o>===</span> <span class=k>null</span> 
</span></span><span class=line><span class=cl>                        <span class=o>?</span> <span class=nv>$achievement</span><span class=o>-&gt;</span><span class=na>ranking</span> 
</span></span><span class=line><span class=cl>                        <span class=o>:</span> <span class=nx>min</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>allTimeRanking</span><span class=p>,</span> <span class=nv>$achievement</span><span class=o>-&gt;</span><span class=na>ranking</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>case</span> <span class=nv>$achievement</span> <span class=nx>instanceof</span> <span class=nx>DogLicenseAchievement</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dogLicensePassed</span> <span class=o>=</span> <span class=nv>$achievement</span><span class=o>-&gt;</span><span class=na>passed</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>The <code>apply</code> function is called with the events from the database, and the entity is in the correct state. For this
pattern a repository is pattern that will help to control the hydration from the DB. <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><h3 id=advantages class="relative group">Advantages <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#advantages aria-label=Anchor>#</a></span></h3><p>Especially when coming from Eloquents Active Record Pattern, this seems a bit complicated, and require some awareness of
the benefits of segregating storing state changes and querying the state.</p><ul><li><strong>Audit Trail</strong>: The event table is a perfect audit trail, as it holds all the changes to the entity. For some
projects of the financial sector this can be required by law, for others a history is &ldquo;only&rdquo; a required user feature,
and worst case this is great to replay the state of the entity at any given point in time for debugging. <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></li><li><strong>Scalability</strong>: The event table is append only, which makes it very easy to scale the database. The only thing that
needs to be ensured is that the events are stored in the correct order. Also horizontal scaling can become very easy
as splitting by <code>dog_id</code> can be done.</li><li><strong>Performance</strong>: The event table is very fast to write, and the separation of query and command ensures that the
database is not blocked by long running queries. For many use cases the reliability of storing has a higher priority.</li><li><strong>Simplicity</strong>: Since years devs (in my bubble) are discussing event sourcing as great pattern, so many devs are aware
of the pattern and will know their way around the code.</li><li><strong>Testing</strong>: Any testcase can be defined and prepared by the starting list of events, and the expected state of the
entity. This makes testing very easy, and the tests very readable.</li></ul><h3 id=disadvantages class="relative group">Disadvantages <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#disadvantages aria-label=Anchor>#</a></span></h3><ul><li><strong>Memory</strong>: Besides the really big table that holds the event data, in our case with the potentially big JSON column,
the entity in memory can become quite big. When one entity is loaded, all events need to be applied to the entity, and
therefore fetched into RAM. Those are problems that are manageable, but need to be considered.</li><li><strong>Eventual consistency</strong>: The entity is not in a consistent state at any given point in time. There might be two
events simultaneously that change the same state, and the order of the events is important. Again here are technical
solutions like locking, or business solutions like making each event idempotent.</li><li><strong>Querying</strong>: The json column might hold events of different types, and the query to get the current state of the
entity can become quite complex. This can be solved by a view, or by storing important information as separate
columns (like in this case <code>contestIdentifier</code>). But when the Product/Dog Owner wants to know if one dog is the best
of breed in all Obedience Contests, the query can become quite complex, when also all other achievements have to be
sorted out.</li><li><strong>Serialization</strong>: The JSON column might hold old events, former versions. The serialization of the events might
change, and the entity might not be able to apply the old events. This can be solved by versioning the events and a
custom deserialization.</li></ul><h2 id=event-sourcing-in-long-living-projects class="relative group">Event Sourcing in long living projects <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#event-sourcing-in-long-living-projects aria-label=Anchor>#</a></span></h2><p>In theory many software patterns are great, but implementing them in a long living project can reveal some challenges.
I would like to share some solutions of the challenges I faced.</p><h3 id=the-database-decision class="relative group">The database decision <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#the-database-decision aria-label=Anchor>#</a></span></h3><p>If the goal of the event sourcing is only storing the current value over time - hold your horses dear PHP Devs - maybe a
relational database is not what you are looking for. Time series databases might be an option. On the other hand if you
don&rsquo;t need to query too much, and just hold the maybe changing data points, a document oriented database might the
easiest solution.</p><p>If you go the for the relational database, most probably because you have a somewhat structured data model and the
requirement to query large sets of data points based on properties in typed columns, there still might be a need for a
json column. If I could choose to avoid it, I would. If the feature sets does not allow avoiding it, I highly recomend
Postgres&rsquo; jsonb column (with or without an index) over mariaDbs json column. <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></p><h3 id=event-versioning-using-a-discriminator-map class="relative group">Event Versioning using a discriminator map <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#event-versioning-using-a-discriminator-map aria-label=Anchor>#</a></span></h3><p>The day might come in which the event structure changes. A new field is added to an event, an old event is obsolete -
one day there will be an event stored in the database that is not easily applied to the entity. An implementation where
this can not happen, because all events are serialized to the same class, with the identifier stored in an enum to hide
the complexity of versioning is possible - which would make this paragraph obsolete. Often the different events are
instantiated to different classes.</p><div class="flex rounded-md bg-primary-100 px-4 py-3 dark:bg-primary-900"><span class="pe-3 text-primary-400"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M506.3 417 293 53c-16.33-28-57.54-28-73.98.0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6c32.76.0 53.26-35 36.96-63zM232 168c0-13.25 10.75-24 24-24s24 10.8 24 24v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zm24 248c-17.36.0-31.44-14.08-31.44-31.44s14.07-31.44 31.44-31.44 31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z"/></svg>
</span></span><span class=dark:text-neutral-300>Decisions like how to name the identifier and what process to follow when an event is changed should be discussed in the
team and best case documented in e.g. Architecture Decision Records.</span></div><p>There needs to be an identifier to the type. In the easiest implementation the fully classified class name is stored in
the database - which would cause migrations on a directory name change. Therefore, the identifier should be a string.
As the string should be only used by the constant, it doesn&rsquo;t need to be human-readable.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// a string identifier with version
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>public</span> <span class=k>const</span> <span class=no>ACHIEVED_OBEDIENCE</span> <span class=o>=</span> <span class=s1>&#39;achieved.v1.obidience&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>// a string that is non human-readable, to decouple class name and identifier
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>public</span> <span class=k>const</span> <span class=no>ACHIEVED_OBEDIENCE_V2</span> <span class=o>=</span> <span class=s1>&#39;achieved.cda6d2f8-feaf-4818-a061-95228e0f3957&#39;</span><span class=p>;</span>
</span></span></code></pre></div><p>In Laravel this can be handled by Morph Maps and a Morph Many Relationship <sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>Relation</span><span class=o>::</span><span class=na>enforceMorphMap</span><span class=p>([</span>
</span></span><span class=line><span class=cl>    <span class=nx>Achievement</span><span class=o>::</span><span class=na>ACHIEVED_OBEDIENCE_V1</span><span class=p>,</span> <span class=nx>Achievement</span><span class=o>::</span><span class=na>ACHIEVED_OBEDIENCE_V2</span> <span class=o>=&gt;</span> <span class=nx>ObedienceAchievement</span><span class=o>::</span><span class=na>class</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>Achievement</span><span class=o>::</span><span class=na>ACHIEVED_DOG_LICENSE_V1</span> <span class=o>=&gt;</span> <span class=nx>DogLicenseAchievement</span><span class=o>::</span><span class=na>class</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>]);</span>
</span></span></code></pre></div><p>In Symfony the instantiation often happens more declarative, which also might cause a lot more boilerplate code. But
Symfony does support a similar feature <sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>. These exact implementation will not be discussed here, as I
personally had multiple problems implementing it. On one hand in this particular project the attributes were not an
option, on the other I require the discriminator map to be in code for better maintainability (if you can not click on
it, you will not maintain it); also, I found myself debugging the Injection of the resulting serializer very hard -
please feel free to teach me better and share your implementation.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>fromArray</span><span class=p>(</span><span class=k>array</span> <span class=nv>$row</span><span class=p>)</span><span class=o>:</span> <span class=nx>Achievement</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$identifier</span> <span class=o>=</span> <span class=nv>$data</span><span class=p>[</span><span class=s1>&#39;identifier&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>match</span> <span class=p>(</span><span class=nv>$identifier</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>self</span><span class=o>::</span><span class=na>ACHIEVED_OBEDIENCE_V2</span> <span class=o>=&gt;</span> <span class=k>new</span> <span class=nx>ObedienceAchievement</span><span class=p>(</span><span class=nv>$row</span><span class=p>[</span><span class=s1>&#39;contestIdentifier&#39;</span><span class=p>],</span> <span class=nv>$row</span><span class=p>[</span><span class=s1>&#39;points&#39;</span><span class=p>],</span> <span class=nv>$row</span><span class=p>[</span><span class=s1>&#39;ranking&#39;</span><span class=p>],</span> <span class=nv>$row</span><span class=p>[</span><span class=s1>&#39;recordedAt&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>        <span class=c1>// historically there was no contest identifier in the past, however all contests before the change had the same identifier
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>self</span><span class=o>::</span><span class=na>ACHIEVED_OBEDIENCE_V1</span> <span class=o>=&gt;</span> <span class=k>new</span> <span class=nx>ObedienceAchievement</span><span class=p>(</span><span class=s1>&#39;Obedience Trail 2023&#39;</span><span class=p>,</span> <span class=nv>$row</span><span class=p>[</span><span class=s1>&#39;points&#39;</span><span class=p>],</span> <span class=nv>$row</span><span class=p>[</span><span class=s1>&#39;ranking&#39;</span><span class=p>],</span> <span class=nv>$row</span><span class=p>[</span><span class=s1>&#39;recordedAt&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>        <span class=k>default</span> <span class=o>=&gt;</span> <span class=k>throw</span> <span class=k>new</span> <span class=nx>InvalidArgumentException</span><span class=p>(</span><span class=s1>&#39;Unknown identifier: &#39;</span> <span class=o>.</span> <span class=nv>$identifier</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=event-deserialization class="relative group">Event deserialization <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#event-deserialization aria-label=Anchor>#</a></span></h3><p>Repository classes containing to instantiate entities from the database are sometimes quite big and messy.
A cleaner solution for this problem that comes in handy with instantiating events from json or from a raw database row
is using a normalizer. <sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>class</span> <span class=nc>AchievementNormalizer</span> <span class=k>implements</span> <span class=nx>NormlizerInterface</span><span class=p>,</span> <span class=nx>DenormalizerInterface</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>const</span> <span class=no>ACHIEVEMENTS_MAP</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=nx>Achievement</span><span class=o>::</span><span class=na>ACHIEVED_OBEDIENCE_V1</span><span class=p>,</span> <span class=nx>Achievement</span><span class=o>::</span><span class=na>ACHIEVED_OBEDIENCE_V2</span> <span class=o>=&gt;</span> <span class=nx>ObedienceAchievement</span><span class=o>::</span><span class=na>class</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>Achievement</span><span class=o>::</span><span class=na>ACHIEVED_DOG_LICENSE_V1</span> <span class=o>=&gt;</span> <span class=nx>DogLicenseAchievement</span><span class=o>::</span><span class=na>class</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>];</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>(</span><span class=k>private</span> <span class=nx>ObjectNormalizer</span> <span class=nv>$normalizer</span><span class=p>)</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>normalize</span><span class=p>(</span><span class=nv>$object</span><span class=p>,</span> <span class=nx>string</span> <span class=nv>$format</span> <span class=o>=</span> <span class=k>null</span><span class=p>,</span> <span class=k>array</span> <span class=nv>$context</span> <span class=o>=</span> <span class=p>[])</span><span class=o>:</span> <span class=k>array</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>normalizer</span><span class=o>-&gt;</span><span class=na>normalize</span><span class=p>(</span><span class=nv>$object</span><span class=p>,</span> <span class=nv>$format</span><span class=p>,</span> <span class=nv>$context</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>denormalize</span><span class=p>(</span><span class=nv>$data</span><span class=p>,</span> <span class=nx>string</span> <span class=nv>$type</span><span class=p>,</span> <span class=nx>string</span> <span class=nv>$format</span> <span class=o>=</span> <span class=k>null</span><span class=p>,</span> <span class=k>array</span> <span class=nv>$context</span> <span class=o>=</span> <span class=p>[])</span><span class=o>:</span> <span class=nx>Achievement</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$identifier</span> <span class=o>=</span> <span class=nv>$data</span><span class=p>[</span><span class=s1>&#39;identifier&#39;</span><span class=p>]</span> <span class=o>??</span> <span class=k>throw</span> <span class=k>new</span> <span class=nx>InvalidArgumentException</span><span class=p>(</span><span class=s1>&#39;No identifier found&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nv>$identifier</span> <span class=o>==</span> <span class=s1>&#39;*the super old identifier we do barely support*&#39;</span><span class=p>){</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>new</span> <span class=nx>DepricatedAchievement</span><span class=p>(</span><span class=nv>$identifier</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>        <span class=nv>$type</span> <span class=o>=</span> <span class=nx>self</span><span class=o>::</span><span class=na>ACHIEVEMENTS_MAP</span><span class=p>[</span><span class=nv>$identifier</span><span class=p>]</span> <span class=o>??</span> <span class=k>throw</span> <span class=k>new</span> <span class=nx>InvalidArgumentException</span><span class=p>(</span><span class=s1>&#39;Unknown type: &#39;</span> <span class=o>.</span> <span class=nv>$identifier</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>normalizer</span><span class=o>-&gt;</span><span class=na>denormalize</span><span class=p>(</span><span class=nv>$data</span><span class=p>,</span> <span class=nv>$type</span><span class=p>,</span> <span class=nv>$format</span><span class=p>,</span> <span class=nv>$context</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>supportsDenormalization</span><span class=p>(</span><span class=nv>$data</span><span class=p>,</span> <span class=nx>string</span> <span class=nv>$type</span><span class=p>,</span> <span class=nx>string</span> <span class=nv>$format</span> <span class=o>=</span> <span class=k>null</span><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$type</span> <span class=o>===</span> <span class=nx>Achievement</span><span class=o>::</span><span class=na>class</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getSupporedClass</span><span class=p>()</span><span class=o>:</span> <span class=k>array</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=p>[</span><span class=nx>Achievement</span><span class=o>::</span><span class=na>class</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Having a special normalizer for this enables the developer to have a clean repository class, but still provides a place
to hook into the deserialization process, set defaults for old fields, or throw exceptions for unknown fields.
The discriminator map is hold in code, so any code editor can jump to the events, and back.</p><p>A test could look like:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>testSerializeAndDeserialize</span><span class=p>()</span><span class=o>:</span> <span class=nx>void</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$achievement</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>ObedienceAchievement</span><span class=p>(</span><span class=s1>&#39;Obedience Trail 2023&#39;</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$encodedAchievement</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>serializer</span><span class=o>-&gt;</span><span class=na>serialize</span><span class=p>(</span><span class=nv>$achievement</span><span class=p>,</span> <span class=s1>&#39;json&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nv>$achievementArray</span> <span class=o>=</span> <span class=nx>json_decode</span><span class=p>(</span><span class=nv>$encodedAchievement</span><span class=p>,</span> <span class=k>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>assertArrayHasKey</span><span class=p>(</span><span class=s1>&#39;identifier&#39;</span><span class=p>,</span> <span class=nv>$achievementArray</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>assertEquals</span><span class=p>(</span><span class=nx>Achievement</span><span class=o>::</span><span class=na>ACHIEVED_OBEDIENCE_V2</span><span class=p>,</span> <span class=nv>$achievementArray</span><span class=p>[</span><span class=s1>&#39;identifier&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nv>$deserialized</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>serializer</span><span class=o>-&gt;</span><span class=na>deserialize</span><span class=p>(</span><span class=nv>$encodedAchievement</span><span class=p>,</span> <span class=nx>Achievement</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;json&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>assertInstanceOf</span><span class=p>(</span><span class=nx>ObedienceAchievement</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=nv>$deserialized</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Also, a test that grabs all achievements from the directory folder and checks if they can be deserialized should be
added to ensure that the map is always updated when a developer adds a new achievement.</p><h2 id=conclusion class="relative group">Conclusion <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#conclusion aria-label=Anchor>#</a></span></h2><p>Event Sourcing is a great pattern, and for certain use cases the best solution. The implementation can be quite tricky,
but if the team works through the current and future challenges, the pattern can be a great addition to the project.</p><p>Happy Coding :)</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Implementation idea and code snippets are inspired by the book &ldquo;Implementing Domain-Driven Design&rdquo; by
Vaughn Vernon.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://event-driven.io/en/audit_log_event_sourcing/ target=_blank rel=noreferrer>Audit Trailing via event sourcing</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href=https://www.postgresql.org/docs/current/datatype-json.html target=_blank rel=noreferrer>Postgres JSONB</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p><a href=https://laravel.com/docs/11.x/eloquent-relationships#custom-polymorphic-types target=_blank rel=noreferrer>Laravel Morph Maps</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p><a href=https://symfony.com/doc/current/components/serializer.html#serializing-interfaces-and-abstract-classes target=_blank rel=noreferrer>Symfony Discriminator Map</a>&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p><a href=https://symfony.com/doc/current/serializer/custom_normalizer.html target=_blank rel=noreferrer>Symfony Normalizer</a>&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></section><footer class="max-w-prose pt-8 print:hidden"><div class=flex><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Sofia Fischer</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=mailto:sofia@philodev.com target=_blank aria-label=Email rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg>
</span></a><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=https://github.com/sofia-fischer target=_blank aria-label=Github rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></a><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=https://www.linkedin.com/in/sofia-fischer-58b1611b9/ target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></a></div></div></div></div><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="group flex" href=/posts/2024-02-feature-flags/><span class="me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class="ltr:inline rtl:hidden">&larr;</span><span class="ltr:hidden rtl:inline">&rarr;</span></span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Gitlab Feature Flags (for Backends)</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2024-03-05 10:20:44 +0200 +0200">5 March 2024</time>
</span></span></a></span><span><a class="group flex text-right" href=/posts/2024-05-agile-architecture/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Agile Software Architecture</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2024-05-28 10:20:44 +0200 CEST">28 May 2024</time>
</span></span><span class="ms-2 text-neutral-700 transition-transform group-hover:-translate-x-[-2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class="ltr:inline rtl:hidden">&rarr;</span><span class="ltr:hidden rtl:inline">&larr;</span></span></a></span></div></div></footer></article></main><div class="pointer-events-none absolute bottom-0 end-0 top-[100vh] w-12" id=to-top hidden=true><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div><footer class="py-10 print:hidden"><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2024
Sofia Fischer</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://github.com/jpanther/congo target=_blank rel="noopener noreferrer">Congo</a></p></div><div class="flex flex-row items-center"><div class="me-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"><button id=appearance-switcher-0 type=button aria-label="appearance switcher"><div class="flex h-12 w-12 items-center justify-center dark:hidden" title="Switch to dark appearance"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="hidden h-12 w-12 items-center justify-center dark:flex" title="Switch to light appearance"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div></div></footer></div></body></html>